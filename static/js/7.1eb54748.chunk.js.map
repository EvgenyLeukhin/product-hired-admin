{"version":3,"sources":["components/Header/HeaderTitle.js","img/no-logo.jpg","views/Pages/Jobs.js"],"names":["withHeaderTitle","WrappedComponent","_Component","HeaderTitle","Object","_Users_effectiveuser_Desktop_ph_admin_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","_Users_effectiveuser_Desktop_ph_admin_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","_Users_effectiveuser_Desktop_ph_admin_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","apply","arguments","_Users_effectiveuser_Desktop_ph_admin_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__","_Users_effectiveuser_Desktop_ph_admin_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__","key","value","newProp","setHeaderTitle","headerTitle","pubsub","publish","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","assign","props","Component","module","exports","Jobs","state","data","count","loading","_this2","columns","Header","accessor","width","Cell","_ref","original","style","textAlign","id","fontWeight","_ref2","name","sortable","filterable","_ref3","locations","map","i","concat","_ref4","created","substring","_this$state","react_table__WEBPACK_IMPORTED_MODULE_6__","pages","manual","resizable","className","onFetchData","pageSize","page","sorted","filtered","setState","filter","where","limit","skip","order","forEach","like","desc","axios","get","API_URL","params","headers","Authorization","localStorage","getItem","then","res","Math","ceil","console","log","catch","error","React"],"mappings":"uMAGO,SAASA,EAAgBC,GAC5B,gBAAAC,GAAA,SAAAC,IAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAH,GAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAD,GAAAM,MAAAH,KAAAI,YAAA,OAAAN,OAAAO,EAAA,EAAAP,CAAAD,EAAAD,GAAAE,OAAAQ,EAAA,EAAAR,CAAAD,EAAA,EAAAU,IAAA,SAAAC,MAAA,WAEQ,IAAMC,EAAU,CACZC,eAAgB,SAAAC,GACZC,IAAOC,QAAQ,eAAgBF,KAGvC,OAAOG,EAAAC,EAAAC,cAACrB,EAADG,OAAAmB,OAAA,GAAsBjB,KAAKkB,MAAWT,QAPrDZ,EAAA,CAAiCsB,iCCJrCC,EAAAC,QAAA,2zBCeMC,6MACJC,MAAQ,CACNC,KAAM,GACNC,MAAO,KACPC,SAAS,8FAImB1B,KAAKkB,MAAMR,eAAe,yCAE/C,IAAAiB,EAAA3B,KAED4B,EAAU,CACd,CACEC,OAAQ,KACRC,SAAU,KACVC,MAAO,GACPC,KAAM,SAAAC,GAAA,IAAGC,EAAHD,EAAGC,SAAH,OACJpB,EAAAC,EAAAC,cAAA,OAAKmB,MAAO,CAAEC,UAAW,UACvBtB,EAAAC,EAAAC,cAAA,YAAOkB,EAASG,IAAM,UAK5B,CACER,OAAQ,OACRC,SAAU,OACVK,MAAO,CAAEG,WAAY,QACrBN,KAAM,SAAAO,GAAA,IAAGL,EAAHK,EAAGL,SAAH,OACJpB,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAAA,YAAOkB,EAASM,MAAQ,UAK9B,CACEX,OAAQ,WACRC,SAAU,YACVC,MAAO,IACPU,UAAU,EACVC,YAAY,EACZV,KAAM,SAAAW,GAAA,IAAGT,EAAHS,EAAGT,SAAH,OACJpB,EAAAC,EAAAC,cAAA,OAAKmB,MAAO,CAAEC,UAAW,WACvBtB,EAAAC,EAAAC,cAAA,YAAOkB,EAASU,UAAUC,IAAI,SAAAC,GAAC,SAAAC,OAAOD,EAAEN,KAAT,WAKrC,CACEX,OAAQ,UACRC,SAAU,UACVC,MAAO,IACPC,KAAM,SAAAgB,GAAA,IAAGd,EAAHc,EAAGd,SAAH,OACJpB,EAAAC,EAAAC,cAAA,OAAKmB,MAAO,CAAEC,UAAW,WACvBtB,EAAAC,EAAAC,cAAA,YAAOkB,EAASe,QAAQC,UAAU,EAAG,KAAO,WA5C7CC,EAkD0BnD,KAAKuB,MAA9BC,EAlDD2B,EAkDC3B,KAAME,EAlDPyB,EAkDOzB,QAASD,EAlDhB0B,EAkDgB1B,MAEvB,OACEX,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAACoC,EAAA,EAAD,CACEC,MAAO5B,EACP6B,QAAQ,EACR9B,KAAMA,EACNE,QAASA,EACT6B,WAAW,EACXb,YAAY,EACZc,UAAU,sBACV5B,QAASA,EACT6B,YAAa,SAAAlC,GAAS,IAKZmC,EAAqCnC,EAArCmC,SAAUC,EAA2BpC,EAA3BoC,KAAMC,EAAqBrC,EAArBqC,OAAQC,EAAatC,EAAbsC,SAEhClC,EAAKmC,SAAS,CAAEpC,SAAS,IAGzB,IAAMqC,EAAS,CACbC,MAAO,GACPC,MAAOP,EACPQ,KAAMP,EAAOD,EACbS,MAAO,WAITN,EAASO,QAAQ,SAAAtB,GACF,OAATA,EAAET,GAAa0B,EAAOC,MAAMlB,EAAET,IAAMS,EAAEtC,MACvBuD,EAAOC,MAAMlB,EAAET,IAAM,CAAEgC,KAAQvB,EAAEtC,MAAQ,OAI9DoD,EAAOQ,QAAQ,SAAAtB,GACb,IAAMwB,EAAOxB,EAAEwB,KAAO,OAAS,MAC/BP,EAAOI,MAAP,GAAApB,OAAkBD,EAAET,GAApB,KAAAU,OAA0BuB,KAK5BC,IAAMC,IAAN,GAAAzB,OAAa0B,IAAb,4BAAgD,CAE9CC,OAAQ,CAAEV,MAAOD,EAAOC,OACxBW,QAAS,CAAEC,cAAeC,aAAaC,QAAQ,qBAG/CC,KAAK,SAAAC,GAILrD,EAAKmC,SAAS,CAAErC,MAAOwD,KAAKC,KAAKF,EAAIxD,KAAKC,MAAQiC,OAGjDqB,KACDR,IAAMC,IAAN,GAAAzB,OAAa0B,IAAb,sBAA0C,CACxCC,OAAQ,CAAEX,UACVY,QAAS,CAAEC,cAAeC,aAAaC,QAAQ,qBAE9CC,KAAK,SAAAC,GACNG,QAAQC,IAAIJ,EAAIxD,MAChBG,EAAKmC,SAAS,CAEZtC,KAAMwD,EAAIxD,KACVE,SAAS,MAIV2D,MAAM,SAAAC,GAAWH,QAAQC,IAAIE,iBAnI3BC,IAAMpE,WA4IVzB,sBAAgB4B","file":"static/js/7.1eb54748.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport pubsub from \"pubsub-js\";\r\n\r\nexport function withHeaderTitle(WrappedComponent) {\r\n    return class HeaderTitle extends Component {\r\n        render() {\r\n            const newProp = {\r\n                setHeaderTitle: headerTitle => {\r\n                    pubsub.publish(\"setPageTitle\", headerTitle);\r\n                }\r\n            };\r\n            return <WrappedComponent {...this.props} {...newProp} />;\r\n        }\r\n    };\r\n}\r\n","module.exports = \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAUFBQUFBQYGBgYICQgJCAwLCgoLDBINDg0ODRIbERQRERQRGxgdGBYYHRgrIh4eIisyKigqMjw2NjxMSExkZIYBBQUFBQUFBgYGBggJCAkIDAsKCgsMEg0ODQ4NEhsRFBERFBEbGB0YFhgdGCsiHh4iKzIqKCoyPDY2PExITGRkhv/CABEIABQAFAMBIgACEQEDEQH/xAAXAAADAQAAAAAAAAAAAAAAAAAABAYI/9oACAEBAAAAANlqNqytoB//xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oACAECEAAAAA//xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oACAEDEAAAAA//xAAhEAACAgIBBAMAAAAAAAAAAAABAgMEBRIhAAYRIhATIP/aAAgBAQABPwC9bix9K1clDGOCF5XCjyxVBsfA6xXcOJzJApTlyQ7AFSOI20Pxnbk1StFpQNtJpTFNHqWAjZG5YKG9fI54PWFztWfLfVV7ZNeR3dZ5kj1MZdy7CQhANi3sefz/AP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8AH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8AH//Z\"","// filtering +++\n// прописать catch для запросов\n// save user data in one object in localStorage\n// checking admin rights when login\n// catch 401 error -> redirect to login\n\nimport React from \"react\";\nimport ReactTable from \"react-table\";\nimport axios from 'axios';\n\nimport { withHeaderTitle } from '../../components/Header/HeaderTitle';\n\nimport noLogo from './../../img/no-logo.jpg';\nimport API_URL from '../../consts/apiUrl';\n\nclass Jobs extends React.Component {\n  state = {\n    data: [],\n    count: null,\n    loading: false,\n  }\n\n  // inject title text\n  UNSAFE_componentWillMount() { this.props.setHeaderTitle('Jobs') }\n\n  render() {\n    // table columns\n    const columns = [\n      {\n        Header: 'ID',\n        accessor: 'id',\n        width: 60,\n        Cell: ({ original }) => (\n          <div style={{ textAlign: 'right' }}>\n            <span>{original.id || '...'}</span>\n          </div>\n        )\n      },\n\n      {\n        Header: 'Name',\n        accessor: 'name',\n        style: { fontWeight: 'bold' },\n        Cell: ({ original }) => (\n          <div>\n            <span>{original.name || '...'}</span>\n          </div>\n        )\n      },\n\n      {\n        Header: 'Location',\n        accessor: 'locations',\n        width: 200,\n        sortable: false,\n        filterable: false,\n        Cell: ({ original }) => (\n          <div style={{ textAlign: 'center' }}>\n            <span>{original.locations.map(i => `${i.name} `)}</span>\n          </div>\n        )\n      },\n\n      {\n        Header: 'Created',\n        accessor: 'created',\n        width: 120,\n        Cell: ({ original }) => (\n          <div style={{ textAlign: 'center' }}>\n            <span>{original.created.substring(0, 10) || '...'}</span>\n          </div>\n        )\n      },\n    ];\n\n    const { data, loading, count } = this.state;\n\n    return (\n      <div>\n        <ReactTable\n          pages={count}\n          manual={true}\n          data={data}\n          loading={loading}\n          resizable={true}\n          filterable={true}\n          className=\"-striped -highlight\"\n          columns={columns}\n          onFetchData={state => {\n            // use ReactTable own state to forming a request\n            // it refresh always when we're doing any actions with this table\n            // console.log(state);\n\n            const { pageSize, page, sorted, filtered } = state;\n\n            this.setState({ loading: true });\n\n            // filter template for request\n            const filter = {\n              where: {},\n              limit: pageSize,\n              skip: page * pageSize,\n              order: 'id DESC' // id DESC - by default\n            };\n\n            // inject values to filter object when we fill data to filter inputs\n            filtered.forEach(i => {\n              if (i.id === 'id') filter.where[i.id] = i.value\n              else               filter.where[i.id] = { 'like': i.value + '%' }\n            });\n\n            // inject data to order when we click sorting\n            sorted.forEach(i => {\n              const desc = i.desc ? 'DESC' : 'ASC'\n              filter.order = `${i.id} ${desc}`;\n            });\n\n\n            // fetch only count\n            axios.get(`${API_URL}/api/api/vacancies/count`, {\n              // params for get count when we have filled filters\n              params: { where: filter.where },\n              headers: { Authorization: localStorage.getItem('ph-admin-token') },\n            }\n\n            ).then(res => {\n              // save count to coponent state\n              // res.data.count - all items inside response\n              // count - we find pages-count to add to Table property pages\n              this.setState({ count: Math.ceil(res.data.count / pageSize) });\n\n            // fetch data only for 1 page\n            }).then(\n              axios.get(`${API_URL}/api/api/vacancies`, {\n                params: { filter },\n                headers: { Authorization: localStorage.getItem('ph-admin-token') }\n\n              }).then(res => {\n                console.log(res.data);\n                this.setState({\n                  // save data to component state\n                  data: res.data,\n                  loading: false\n                });\n\n                // TODO catch errors\n              }).catch(error => { console.log(error) })\n            )\n          }}\n        />\n      </div>\n    );\n  }\n}\n\nexport default withHeaderTitle(Jobs);\n"],"sourceRoot":""}