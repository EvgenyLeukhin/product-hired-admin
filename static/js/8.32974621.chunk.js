(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{419:function(e,t,a){"use strict";a.d(t,"a",function(){return m});var n=a(10),r=a(11),i=a(13),o=a(12),l=a(14),c=a(0),s=a.n(c),u=a(30),d=a.n(u);function m(e){return function(t){function a(){return Object(n.a)(this,a),Object(i.a)(this,Object(o.a)(a).apply(this,arguments))}return Object(l.a)(a,t),Object(r.a)(a,[{key:"render",value:function(){var t={setHeaderTitle:function(e){d.a.publish("setPageTitle",e)}};return s.a.createElement(e,Object.assign({},this.props,t))}}]),a}(c.Component)}},420:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(448);a(421);t.a=function(e){return r.a.createElement(i.a,Object.assign({},e,{resizable:!0,filterable:!0,className:"-striped -highlight"}))}},421:function(e,t,a){},423:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(669);t.a=function(e){var t=e.type,a=e.original,n=e.errorText,o=e.errorAlertIsOpen,l=e.closeErrorAlert,c=a.surname?"".concat(a.name," ").concat(a.surname):"".concat(a.name);return r.a.createElement(r.a.Fragment,null,"add"===t&&r.a.createElement(i.a,{color:"success"},"New item has been added")||"edit"===t&&r.a.createElement(i.a,{color:"warning"},'"'.concat(a.id)," - ",r.a.createElement("b",null,c," has been edited"))||"delete"===t&&r.a.createElement(i.a,{color:"danger"},'"'.concat(a.id)," - ",r.a.createElement("b",null,c," has been deleted"))||"error"===t&&r.a.createElement(i.a,{color:"danger",isOpen:o,toggle:l},n)||"copy"===t&&r.a.createElement(i.a,{color:"warning"},"Copied"))}},424:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(418),o=a.n(i);a(425),a(427),a(429);t.a=function(e){var t=e.isOpen,a=e.modalLoading,n=e.closeModal;return r.a.createElement(o.a,Object.assign({},e,{ariaHideApp:!1,isOpen:t,overlayClassName:"ReactModal__Overlay",className:"ReactModal ReactModal__edit",portalClassName:"ReactModal__Portal__edit",onRequestClose:!a&&n}),e.children)}},425:function(e,t,a){},427:function(e,t,a){},429:function(e,t,a){},681:function(e,t,a){"use strict";a.r(t);var n=a(43),r=a(5),i=a(10),o=a(11),l=a(13),c=a(12),s=a(14),u=a(0),d=a.n(u),m=a(420),p=a(423),g=a(424),h=a(111),f=a(529),v=function(e){var t=e.name,a=e.price,n=e.original,r=e.isOpen,i=e.closeModal,o=e.onChange,l=e.onSubmit,c=e.modalLoading;return d.a.createElement(g.a,{isOpen:r,modalLoading:c,closeModal:i},d.a.createElement("section",{className:"section-container edit-container"},d.a.createElement("h4",{className:"edit-container__title"},"Edit: ",d.a.createElement("b",null,n.name)),d.a.createElement("span",{className:"ion-close-round edit-container__close",onClick:i}),d.a.createElement("div",{className:"cardbox"},d.a.createElement("div",{className:"cardbox-body"},d.a.createElement("form",{action:"",onSubmit:l},d.a.createElement("fieldset",null,d.a.createElement("div",{className:"form-group row"},d.a.createElement("div",{className:"col-md-6"},d.a.createElement("label",{htmlFor:"edit-name"},"Plan"),d.a.createElement("input",{required:!0,name:"name",type:"text",value:t,id:"edit-name",onChange:o,className:"form-control"})),d.a.createElement("div",{className:"col-md-6"},d.a.createElement("label",{htmlFor:"edit-price"},"Price"),d.a.createElement("input",{required:!0,min:0,max:1e4,name:"price",type:"number",value:a,id:"edit-price",onChange:o,className:"form-control"})))),c?d.a.createElement("div",{className:"edit-container__is-loading"},d.a.createElement(h.a,null)):d.a.createElement("footer",{className:"edit-container__buttons"},d.a.createElement(f.a,{outline:!0,color:"secondary",onClick:i},"Cancel"),d.a.createElement(f.a,{disabled:!t||!a,outline:!0,color:"primary",type:"submit"},"Save")))))))},E=a(419),b=a(58),C=a.n(b),O=a(57),y=function(e){var t=JSON.parse(localStorage.getItem("ph-admin-user-data")).id,a=e.pageSize,n=e.page,r=e.filtered,i=e.sorted,o={where:{},limit:a,skip:n*a,order:"id ASC"};return r.forEach(function(e){"id"===e.id?o.where[e.id]=e.value:o.where[e.id]={like:"%"+e.value+"%"}}),i.forEach(function(e){var t=e.desc?"DESC":"ASC";o.order="".concat(e.id," ").concat(t)}),C.a.get("".concat(O.a,"/").concat(O.b,"/plans"),{params:{filter:o},headers:{Authorization:t}})},S=function(e){var t=JSON.parse(localStorage.getItem("ph-admin-user-data")).id,a=e.filtered,n={};return a.forEach(function(e){"id"===e.id?n[e.id]=e.value:n[e.id]={like:"%"+e.value+"%"}}),C.a.get("".concat(O.a,"/").concat(O.b,"/plans/count"),{params:{where:n},headers:{Authorization:t}})},N=function(e,t,a){var n=JSON.parse(localStorage.getItem("ph-admin-user-data")).id;return C.a.patch("".concat(O.a,"/").concat(O.b,"/plans/").concat(e),{name:t,price:a},{headers:{Authorization:n}})},k=a(444),w=[{Header:"Id",accessor:"id",width:60,style:{textAlign:"right"},Cell:function(e){var t=e.original.id;return d.a.createElement("div",{className:"ellipsis-text",title:t||""},t||"")},Filter:function(e){var t=e.filter,a=e.onChange;return d.a.createElement(k.Input,{value:t?t.value:"",onChange:function(e){return a(e.target.value)},style:{width:"100%",height:"38px"},debounceTimeout:800})}},{Header:"Plan",accessor:"name",style:{fontWeight:"bold"},Cell:function(e){var t=e.original.name;return d.a.createElement("div",{className:"ellipsis-text",title:t||""},t||"")},Filter:function(e){var t=e.filter,a=e.onChange;return d.a.createElement(k.Input,{value:t?t.value:"",onChange:function(e){return a(e.target.value)},style:{width:"100%",height:"38px"},debounceTimeout:800})}},{Header:"Price",accessor:"price",Cell:function(e){var t=e.original.price;return d.a.createElement("div",{className:"ellipsis-text",title:"$".concat(t)||""},"$".concat(t)||"")},Filter:function(e){var t=e.filter,a=e.onChange;return d.a.createElement(k.Input,{value:t?t.value:"",onChange:function(e){return a(e.target.value)},style:{width:"100%",height:"38px"},debounceTimeout:800})}}],I=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={plans:[],plansCount:null,tableLoading:!1,original:{},count:null,alertIsOpen:!1,alertType:"",alertErrorText:"",editModalIsOpen:!1,modalLoading:!1,id:null,name:"",price:null},a.onChange=function(e){return a.setState(Object(r.a)({},e.target.name,e.target.value))},a.catchErrors=function(e){401===e.response.status?(localStorage.removeItem("ph-admin-user-data"),a.props.history.push("/login")):a.setState({modalLoading:!1,alertType:"error",alertIsOpen:!0,alertErrorText:"".concat(e,", ").concat(e.response.data.error.sqlMessage)})},a.editClick=function(e){return function(t){t.stopPropagation(),a.setState({editModalIsOpen:!0,original:e,id:e.id,name:e.name,price:e.price,alertIsOpen:!1})}},a.closeModal=function(){return!a.state.modalLoading&&a.setState({editModalIsOpen:!1})},a.editSubmit=function(e){e.preventDefault(),a.setState({modalLoading:!0});var t=a.state,n=t.id,r=t.name,i=t.price;N(n,r,i).then(function(){for(var e=a.state.plans,t=0;t<e.length;t++)e[t].id===n&&(e[t]={id:n,name:r,price:i});a.setState({plans:e,modalLoading:!1,editModalIsOpen:!1,alertType:"edit",alertIsOpen:!0}),setTimeout(function(){a.setState({alertIsOpen:!1})},2e3)}).catch(function(e){return a.catchErrors(e)})},a}return Object(s.a)(t,e),Object(o.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.props.setHeaderTitle("Plans")}},{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keyup",function(t){return 27===t.keyCode&&e.closeModal()})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",function(e){return 27===e.keyCode})}},{key:"render",value:function(){var e=this,t=this.state,a=t.tableLoading,r=t.original,i=t.name,o=t.price,l=t.plans,c=t.plansCount,s=t.editModalIsOpen,u=t.modalLoading,g=t.alertIsOpen,h=t.alertType,f=t.alertErrorText,E=[{Header:"",width:65,sortable:!1,filterable:!1,Cell:function(t){var a=t.original;return d.a.createElement("div",{className:"rt-custom__controls"},d.a.createElement("i",{className:"ion-edit",onClick:e.editClick(a)}))}}];return d.a.createElement("div",{className:"plans-page"},d.a.createElement("p",{className:"md-lg"},"Total records:\xa0",d.a.createElement("b",null,this.state.count&&this.state.count.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","))),g&&d.a.createElement(p.a,{type:h,original:r,errorText:f}),d.a.createElement(v,{name:i,price:o,original:r,isOpen:s,modalLoading:u,closeModal:this.closeModal,onChange:this.onChange,onSubmit:this.editSubmit}),d.a.createElement(m.a,{data:l,manual:!0,pages:c,loading:a,columns:[].concat(Object(n.a)(w),E),getTdProps:function(t,a,n,r){return{onClick:function(t){if(void 0!==a){var n=a.original;return e.editClick(n)(t)}return null}}},onFetchData:function(t){e.setState({tableLoading:!0}),S(t).then(function(a){e.setState({count:a.data.count,plansCount:Math.ceil(a.data.count/t.pageSize)}),y(t).then(function(t){return e.setState({plans:t.data,tableLoading:!1})}).catch(function(t){return e.catchErrors(t)})}).catch(function(t){return e.catchErrors(t)})}}))}}]),t}(d.a.Component);t.default=Object(E.a)(I)}}]);
//# sourceMappingURL=8.32974621.chunk.js.map